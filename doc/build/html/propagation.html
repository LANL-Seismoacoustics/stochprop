

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Propagation Statistics &mdash; stochprop 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Gravity Wave Perturbations" href="gravity.html" />
    <link rel="prev" title="Atmospheric Fitting, Sampling, and Perturbation" href="sampling.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> stochprop
          

          
            
            <img src="_static/lanl_logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="authorship.html">Authorship &amp; License Info</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="analysis.html">Stochastic Propagation Analysis</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="eofs.html">Empirical Orthogonal Function Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="sampling.html">Atmospheric Fitting, Sampling, and Perturbation</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Propagation Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="gravity.html">Gravity Wave Perturbations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="stochprop.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References and Citing Usage</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">stochprop</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="analysis.html">Stochastic Propagation Analysis</a> &raquo;</li>
        
      <li>Propagation Statistics</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/propagation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="propagation-statistics">
<span id="propagation"></span><h1>Propagation Statistics<a class="headerlink" href="#propagation-statistics" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Propagation statistics for path geometry (e.g., arrival location, travel time, direction of arrival) and transmission loss can be computed for use in improving localization and yield estimation analyses, respectively.</p></li>
<li><p>In the case of localization, a general celerity (horizontal group velocity) model is available in InfraPy constructed as a three-component Gaussian-mixture-model (GMM).  This model contains peaks corresponding to the tropospheric, stratospheric, and thermospheric waveguides and has been defined by fitting the parameterized GMM to a kernel density estimate of a full year of ray tracing analyses.</p></li>
</ul>
<div class="align-center figure" id="id1">
<a class="reference internal image-reference" href="_images/cel_dist.jpg"><img alt="alternate text" src="_images/cel_dist.jpg" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">A general travel time model includes three components corresponding to the tropospheric, stratospheric, and thermospheric waveguides.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p>More specific models can be constructed from a limite suite of atmospheric states describing a location and seasonal trend (e.g., winter in the western US) or using an atmospheric state for a specific event with some perturbation analysis.  In either case, propagation simulations are run using the suite of atmospheric states and a statistical model is defined using the outputs to quantify the probability of a given arrival characteristic.</p></li>
</ul>
<div class="align-center figure" id="id2">
<a class="reference internal image-reference" href="_images/stochprop_fig1.jpg"><img alt="alternate text" src="_images/stochprop_fig1.jpg" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Stochastic propagation models are constructing using a suite of possible atmospheric states, propagation modeling applied to each, and a statistical model describing the variability in the resulting set of predicted effects</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="path-geometry-models-pgms">
<h2>Path Geometry Models (PGMs)<a class="headerlink" href="#path-geometry-models-pgms" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p>Path geometry models describing the arrival location, travel time, direction of arrival (back azimuth, inclination angle) can be computed using geometric modeling simulations such as those in the InfraGA/GeoAc package.</p></li>
<li><p>Ray tracing simulations can be run for all atmospheric specification files in a given directory using the <code class="code docutils literal notranslate"><span class="pre">stochprop.propagation.run_infraga</span></code> method by specifying the directory, output file, geometry (3D Cartesian or spherical), CPU count (if the infraGA/GeoAc OpenMPI methods are installed), azimuth and inclination angle ranges, and source location</p>
<blockquote>
<div><ul class="simple">
<li><p>Note: the source location is primarily used in the spherical coordinate option to specify the latitude and longitude of the source, but should also contain the ground elevation for the simulation runs as the third element (e.g., for a source at 30 degrees latitude, 100 degrees longitude, and a ground elevation of 1 km, specify <code class="code docutils literal notranslate"><span class="pre">src_loc=(0.0,</span> <span class="pre">0.0,</span> <span class="pre">1.0)</span></code> or <code class="code docutils literal notranslate"><span class="pre">src_loc=(30.0,</span> <span class="pre">100.0,</span> <span class="pre">1.0)</span></code> for the <code class="code docutils literal notranslate"><span class="pre">geom=&quot;3d&quot;</span></code> or <code class="code docutils literal notranslate"><span class="pre">geom=&quot;sph&quot;</span></code> options, respectively).</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">stochprop</span> <span class="kn">import</span> <span class="n">propagation</span>

<span class="n">propagation</span><span class="o">.</span><span class="n">run_infraga</span><span class="p">(</span><span class="s2">&quot;samples/winter/example-winter&quot;</span><span class="p">,</span> <span class="s2">&quot;prop/winter/example-winter.arrivals.dat&quot;</span><span class="p">,</span> <span class="n">cpu_cnt</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">geom</span><span class="o">=</span><span class="s2">&quot;sph&quot;</span><span class="p">,</span> <span class="n">inclinations</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">45.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">azimuths</span><span class="o">=</span><span class="n">azimuths</span><span class="p">,</span> <span class="n">src_loc</span><span class="o">=</span><span class="n">src_loc</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The resulting infraGA/GeoAc arrival files are concatenated into a single arrivals file and can be ingested to build a path geometry model by once again specifying the geometry and source location.</p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">pgm</span> <span class="o">=</span> <span class="n">propagation</span><span class="o">.</span><span class="n">PathGeometryModel</span><span class="p">()</span>
<span class="n">pgm</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s2">&quot;prop/winter/example-winter.arrivals.dat&quot;</span><span class="p">,</span> <span class="s2">&quot;prop/winter/example-winter.pgm&quot;</span><span class="p">,</span> <span class="n">geom</span><span class="o">=</span><span class="s2">&quot;sph&quot;</span><span class="p">,</span> <span class="n">src_loc</span><span class="o">=</span><span class="n">src_loc</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The path geometry model can later be loaded into a <code class="code docutils literal notranslate"><span class="pre">stochprop.propagation.PathGeometryModel</span></code> instance and visualized to investigate the propagation statistics.</p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">pgm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;prop/winter/example-winter.pgm&quot;</span><span class="p">)</span>
<span class="n">pgm</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">file_id</span><span class="o">=</span><span class="s2">&quot;prop/winter/example-winter&quot;</span><span class="p">,</span> <span class="n">subtitle</span><span class="o">=</span><span class="s2">&quot;winter&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="align-center figure" id="id3">
<a class="reference internal image-reference" href="_images/winter-PGMs.jpg"><img alt="alternate text" src="_images/winter-PGMs.jpg" style="width: 850px;" /></a>
<p class="caption"><span class="caption-text">Stochastic propagation-based path geometry model examples for a winter shows the expected stratospheric waveguide for propagation to the east and azimuth deviations to the north and south due to the strong stratospheric cross winds.</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p>The path geometry models constructed here can be utilized in the InfraPy Bayesian Infrasonic Source Localization (BISL) analysis by specifying them as the <code class="code docutils literal notranslate"><span class="pre">path_geo_model</span></code> for that analysis.</p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">infrapy.location</span> <span class="kn">import</span> <span class="n">bisl</span>

<span class="n">det_list</span> <span class="o">=</span> <span class="n">lklhds</span><span class="o">.</span><span class="n">json_to_detection_list</span><span class="p">(</span><span class="s1">&#39;data/detection_set2.json&#39;</span><span class="p">)</span>
<span class="n">result</span><span class="p">,</span> <span class="n">pdf</span> <span class="o">=</span> <span class="n">bisl</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">det_list</span><span class="p">,</span> <span class="n">path_geo_model</span><span class="o">=</span><span class="n">pgm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="transmission-loss-models-tlms">
<h2>Transmission Loss Models (TLMs)<a class="headerlink" href="#transmission-loss-models-tlms" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Analysis of source characteristics includes estimation of the power of the acoustic signal at some reference distance from the (typically) complex source mechanism</p></li>
<li><p>Such analysis using regional signals requires a propagation model that relates the energy losses along the path, termed the transmission loss and in the case of infrasonic analysis, several methods are available in the NCPAprop software suite from the University of Mississippi</p></li>
<li><p>The NCPAprop modal analysis using the effective sound speed, <code class="code docutils literal notranslate"><span class="pre">modess</span></code>, can be accessed from <code class="code docutils literal notranslate"><span class="pre">stochprop.propagation.run_modess</span></code> to compute transmission loss predictions for all atmospheric specifications in a directory in a similar fashion to the methods above for infraGA/GeoAc.</p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">stochprop</span> <span class="kn">import</span> <span class="n">propagation</span>

<span class="n">f_min</span><span class="p">,</span> <span class="n">f_max</span><span class="p">,</span> <span class="n">f_cnt</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">10</span>
<span class="n">f_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">f_min</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">f_max</span><span class="p">),</span> <span class="n">f_cnt</span><span class="p">)</span>

<span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">f_vals</span><span class="p">:</span>
    <span class="n">propagation</span><span class="o">.</span><span class="n">run_modess</span><span class="p">(</span><span class="s2">&quot;samples/winter/example-winter&quot;</span><span class="p">,</span> <span class="s2">&quot;prop/winter/example-winter&quot;</span><span class="p">,</span> <span class="n">azimuths</span><span class="o">=</span><span class="n">azimuths</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="n">fn</span><span class="p">,</span> <span class="n">clean_up</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">cpu_cnt</span><span class="o">=</span><span class="n">cpu_cnt</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Each run of this method produces a pair of output files, <code class="code docutils literal notranslate"><span class="pre">prop/winter/example-winter_0.100Hz.nm</span></code> and <code class="code docutils literal notranslate"><span class="pre">prop/winter/example-winter_0.100Hz.lossless.nm</span></code> that contain the predicted transmission loss with and without thermo-viscous absorption losses.</p></li>
<li><p>The transmission loss predictions are loaded in frequency by frequency and statistics for transmission as a function of propagation range and azimuth are constructed and written into specified files,</p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">f_vals</span><span class="p">:</span>
    <span class="n">tlm</span> <span class="o">=</span> <span class="n">propagation</span><span class="o">.</span><span class="n">TLossModel</span><span class="p">()</span>
    <span class="n">tlm</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s2">&quot;prop/winter/example-winter&quot;</span> <span class="o">+</span> <span class="s2">&quot;_</span><span class="si">%.3f</span><span class="s2">&quot;</span> <span class="o">%</span><span class="n">fn</span> <span class="o">+</span> <span class="s2">&quot;.nm&quot;</span><span class="p">,</span> <span class="s2">&quot;prop/winter/example-winter&quot;</span> <span class="o">+</span> <span class="s2">&quot;_</span><span class="si">%.3f</span><span class="s2">&quot;</span> <span class="o">%</span><span class="n">fn</span> <span class="o">+</span> <span class="s2">&quot;.tlm&quot;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The transmission loss model can later be loaded into a <code class="code docutils literal notranslate"><span class="pre">stochprop.propagation.TLossModel</span></code> instance and visualized to investigate the propagation statistics similarly to the path geometry models.</p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">tlm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;prop/winter/example-winter_0.359Hz.tlm&quot;</span><span class="p">)</span>
<span class="n">tlm</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">file_id</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;prop/winter/example-winter_0.359Hz), title=(&quot;</span><span class="n">Transmission</span> <span class="n">Loss</span> <span class="n">Statistics</span><span class="s2">&quot; + &#39;</span><span class="se">\n</span><span class="s2">&#39; + &quot;</span><span class="n">winter</span><span class="p">,</span> <span class="mf">0.359</span> <span class="n">Hz</span><span class="s2">&quot;))</span>
</pre></div>
</div>
<div class="align-center figure" id="id4">
<a class="reference internal image-reference" href="_images/winter_0.359_tloss.png"><img alt="alternate text" src="_images/winter_0.359_tloss.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Transmission loss statistics used for source characterization can be constructed using analysis of NCPAprop normal mode algorithm output.</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p>The transmission loss models constructed in <code class="code docutils literal notranslate"><span class="pre">stochprop</span></code> can be utilized in the InfraPy Spectral Yield Estimation (SpYE) algorithm by specifying a set of models and their associated frequencies (see InfraPy example for detection and waveform data setup),</p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">infrapy.characterization</span> <span class="kn">import</span> <span class="n">spye</span>

<span class="c1"># Define detection list, signal-minus-signal spectra,</span>
<span class="c1"># source location, and analysis frequency band</span>

<span class="n">tlms</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">tlms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">f_vals</span><span class="p">)</span>
<span class="n">tlms</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">f_cnt</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">f_cnt</span><span class="p">):</span>
    <span class="n">tlms</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">propagation</span><span class="o">.</span><span class="n">TLossModel</span><span class="p">()</span>
    <span class="n">tlms</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;prop/winter/example-winter_&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">%.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">models</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;Hz.tlm&quot;</span><span class="p">)</span>

<span class="n">yld_vals</span><span class="p">,</span> <span class="n">yld_pdf</span><span class="p">,</span> <span class="n">conf_bnds</span> <span class="o">=</span> <span class="n">spye</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">det_list</span><span class="p">,</span> <span class="n">smn_specs</span><span class="p">,</span> <span class="n">src_loc</span><span class="p">,</span> <span class="n">freq_band</span><span class="p">,</span> <span class="n">tlms</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="gravity.html" class="btn btn-neutral float-right" title="Gravity Wave Perturbations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="sampling.html" class="btn btn-neutral float-left" title="Atmospheric Fitting, Sampling, and Perturbation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Philip Blom

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>