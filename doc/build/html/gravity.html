

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Gravity Wave Perturbations &mdash; stochprop 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API" href="stochprop.html" />
    <link rel="prev" title="Propagation Statistics" href="propagation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> stochprop
          

          
            
            <img src="_static/lanl_logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="authorship.html">Authorship &amp; License Info</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="analysis.html">Stochastic Propagation Analysis</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="eofs.html">Empirical Orthogonal Function Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="sampling.html">Atmospheric Fitting, Sampling, and Perturbation</a></li>
<li class="toctree-l2"><a class="reference internal" href="propagation.html">Propagation Statistics</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Gravity Wave Perturbations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="stochprop.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References and Citing Usage</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">stochprop</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="analysis.html">Stochastic Propagation Analysis</a> &raquo;</li>
        
      <li>Gravity Wave Perturbations</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/gravity.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="gravity-wave-perturbations">
<span id="gravity"></span><h1>Gravity Wave Perturbations<a class="headerlink" href="#gravity-wave-perturbations" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Atmospheric specifications (e.g., G2S) available for a given location and time are averaged over some spatial and temporal scale so that sub-grid scale fluctuations can be estimated stochastically and applied in order to construct a suite of possible atmospheric states and the primary source of sub-grid fluctuations in the atmosphere is that of bouyancy or gravity waves.</p></li>
<li><p>The methods available in <code class="code docutils literal notranslate"><span class="pre">stochprop</span></code> are based on the vertical ray tracing approach detailed in Drob et al. (2013) and are summarized below for reference.</p></li>
</ul>
<div class="section" id="freely-propagation-and-trapped-gravity-waves">
<h2>Freely Propagation and Trapped Gravity Waves<a class="headerlink" href="#freely-propagation-and-trapped-gravity-waves" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>The gravity wave dynamics are governed by a pair relations describing the disperion and wave action conservation.  The dispersion relation can be expressed as,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[m^2 \left( k, l, \omega, z \right) = \frac{k_h^2}{\hat{\omega}^2} \left( N^2 - \hat{\omega}^2 \right) + \frac{1}{4H^2}\]</div>
<ul class="simple">
<li><p>In this relation <span class="math notranslate nohighlight">\(k\)</span> and <span class="math notranslate nohighlight">\(l\)</span> are the zonal and meridional wave numbers, <span class="math notranslate nohighlight">\(k_h^2 = \sqrt{k^2 + l^2}\)</span> is the combined horizontal wavenumber, <span class="math notranslate nohighlight">\(H = - \rho_0 \times \left( \frac{\partial \rho_0}{\partial z} \right)^{-1}\)</span> is the scale height, <span class="math notranslate nohighlight">\(N^2 = \sqrt{-\frac{g}{\rho_0} \frac{\partial \rho_0}{\partial z}} = \sqrt{\frac{g}{H}}\)</span> is the atmospheric bouyancy frequency, and <span class="math notranslate nohighlight">\(\hat{\omega}\)</span> is the intrinsic angular frequency (relative to the moving air) that is defined relative to the absolute angular frequency (relative to the ground), <span class="math notranslate nohighlight">\(\omega\)</span>,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\hat{\omega} = \omega - k u_0 \left( z \right) - l v_0 \left( z \right)\]</div>
<ul class="simple">
<li><p>This dispersion relation can alternately be solved for <span class="math notranslate nohighlight">\(\hat{\omega}\)</span> and used to define the vertical group velocity,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\hat{\omega} = \frac{k_h N \left( z \right)}{\sqrt{ k_h^2 + m^2 \left( z \right) + \frac{1}{4 H^2 \left( z \right)}}} \quad \rightarrow \quad
c_g = \frac{\partial \hat{\omega}}{\partial m} = -\frac{m k_h N}{\left( k_h^2 + m^2 + \frac{1}{4 H^2} \right)^\frac{3}{2}}\]</div>
<ul class="simple">
<li><p>The conservation of wave action leads to a condition on the vertical velocity perturbation spectrum that can be used to define a freely propagating solution,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\rho_0 m \left| \hat{w} \right|^2 = \text{constant} \; \rightarrow \;
\hat{w} \left( k, l, \omega, z \right) = \hat{w}_0 e^{i \varphi_0} \sqrt{ \frac{\rho_0 \left( z_0 \right)}{\rho_0 \left( z \right)} \frac{m \left( z_0 \right)}{m \left( z \right)}} e^{i \int_{z_0}^z{m \left( z^\prime \right) dz^\prime}}\]</div>
<ul>
<li><p>The above relation is valid in the case that <span class="math notranslate nohighlight">\(m \left( k, l, \omega, z \right)\)</span> remains real through the integration upward in the exponential.  In the case that an altitude exists for which the vertical wavenumber becomes imaginary, the gravity wave energy reflects from this turning height and the above relation is not valid.  Instead, the solution is expressed in the form,</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\hat{w} \left( k, l, \omega, z \right) = 2 i \sqrt{\pi} \hat{w}_0 \sqrt{ \frac{\rho_0 \left( z_0 \right)}{\rho_0 \left( z \right)} \frac{m \left( z_0 \right)}{m \left( z \right)}} \times \left( - r \right)^\frac{1}{4} \text{Ai} \left( r \right) e^{-i \frac{\pi}{4}} S_n\]</div>
<ul class="simple">
<li><p>The Airy function argument in the above is defined uniquely above and below the turning height <span class="math notranslate nohighlight">\(z_t\)</span>,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}r = \left\{ \begin{matrix} - \left( \frac{3}{2} \int_z^{z_t} \left| m \left( z^\prime \right) \right| dz^\prime \right)^\frac{2}{3} &amp; z &lt; z_t \\ \left( \frac{3}{2} \int_{z_t}^z \left| m \left( z^\prime \right) \right| dz^\prime \right)^\frac{2}{3} &amp; z &gt; z_t \end{matrix} \right.\end{split}\]</div>
<ul class="simple">
<li><p>The reflection phase factor, <span class="math notranslate nohighlight">\(S_n\)</span>, accounts for the caustic phase shifts from the <span class="math notranslate nohighlight">\(n\)</span> reflections from the turning height,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[S_n = \sum_{j = 1}^n{e^{i \left( j -1 \right) \left(2 \Phi - \frac{\pi}{2} \right)}}, \quad \Phi = \int_0^{z_t} m \left( z^\prime \right) d z^\prime\]</div>
</div></blockquote>
</li>
<li><p>Lastly, the vertical velocity spectra defined here can be related to the horizontal velocity for the freely propagating and trapped scenarios,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\hat{u}^\text{(free)} = - \frac{k m}{k_h^2} \hat{w}, \quad
\hat{u}^\text{(trapped)} = \frac{2 i \hat{w}_0 }{\sqrt{\pi}}\frac{k}{k_h^2} \sqrt{ \frac{\rho_0 \left( z_0 \right)}{\rho_0 \left( z \right)} \frac{m \left( z_0 \right)}{m \left( z \right)}} \times \left( - r \right)^\frac{1}{4} \text{Ai}^\prime \left( r \right) e^{-i \frac{\pi}{4}} S_n\]</div>
<div class="math notranslate nohighlight">
\[\hat{v}^\text{(free)} = - \frac{l m}{k_h^2} \hat{w}, \quad
\hat{v}^\text{(trapped)} = \frac{2 i \hat{w}_0 }{\sqrt{\pi}}\frac{l}{k_h^2} \sqrt{ \frac{\rho_0 \left( z_0 \right)}{\rho_0 \left( z \right)} \frac{m \left( z_0 \right)}{m \left( z \right)}} \times \left( - r \right)^\frac{1}{4} \text{Ai}^\prime \left( r \right) e^{-i \frac{\pi}{4}} S_n\]</div>
</div>
<div class="section" id="damping-source-and-saturation-spectra-and-critical-layers">
<h2>Damping, Source and Saturation Spectra, and Critical Layers<a class="headerlink" href="#damping-source-and-saturation-spectra-and-critical-layers" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p>At altitudes above about 100 km, gravity wave damping by molecular viscosity and thermal diffusion becomes increasingly important.  Following the methods developed by Drob et al. (2013), for altitudes above 100 km, an imaginary vertical wave number term can be defined, <span class="math notranslate nohighlight">\(m \rightarrow m + m_i\)</span>, where,</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[m_i \left(k, l, \omega, z \right) = -\nu \frac{m^3}{\hat{\omega}}, \quad \nu = 3.563 \times 10^{-7} \frac{T_0^{\, 0.69}}{\rho_0}\]</div>
<ul class="simple">
<li><p>This produces a damping factor for the freely propagating solution that is integrated upward along with the phase,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\hat{w} \left( k, l, \omega, z \right) = \hat{w}_0 e^{i \varphi_0} \sqrt{ \frac{\rho_0 \left( z_0 \right)}{\rho_0 \left( z \right)} \frac{m \left( z_0 \right)}{m \left( z \right)}} e^{i \int_{z_0}^z{m \left( z^\prime \right) dz^\prime}} e^{-\int_{z_0}^{z}{m_i \left( z^\prime \right) dz^\prime}}\]</div>
<ul class="simple">
<li><p>In the trapped solution, the reflection phase shift includes losses for each pass up to the turning height and back,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[S_n = e^{-2 n \Psi} \sum_{j = 1}^n{e^{i \left( j -1 \right) \left(2 \Phi - \frac{\pi}{2} \right)}}, \quad \Phi = \int_0^{z_t} m \left( z^\prime \right) d z^\prime, \quad \Psi = \int_0^{z_t} m_i \left( z^\prime \right) d z^\prime,\]</div>
<ul class="simple">
<li><p>Note that in both of these forms if <span class="math notranslate nohighlight">\(z_t\)</span> is below 100 km there is no loss calculated and when it is above this altitude the losses are only computed from 100 km up to the turning height.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>The source spectra defined by Warner &amp; McIntyre (1996) specifies the wave energy density as,</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\mathcal{E}_\text{src} \left(k, l, \omega \right) = 1.35 \times 10^{-2} \frac{m}{m_*^4 + m^4} \frac{N^2}{\hat{\omega}^3} \Omega, \quad \Omega = \frac{\hat{\omega}_\text{min}^\frac{2}{3}}{1 - \left( \frac{\hat{\omega}_\text{min}}{N} \right)^\frac{2}{3}}, \quad m_* = \frac{2 \pi}{2.5 \text{km}}\]</div>
<ul class="simple">
<li><p>The wave energy density can be related to the vertical velocity spectrum producing the initial condition for starting the calculation,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\mathcal{E} \left(k, l, \omega \right) = \frac{1}{2} \frac{N^2}{\hat{\omega}^2} \left| \hat{w}_0 \right|^2 \quad \rightarrow \quad \left| \hat{w}_0 \right|^2 = 2.7 \times 10^{-2} \frac{m^2}{m^4_* + m^4}  \frac{\Omega}{\hat{\omega} k_h^2}.\]</div>
</div></blockquote>
</li>
<li><p>Gravity wave breaking in the atmosphere is included in analysis via a saturation limit following work by Warner &amp; McIntyre (1996) where the spectral coordinate saturation spectrum is,</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\mathcal{E}_\text{sat} \left(k, l, \omega \right) = 1.35 \times 10^{-2} \frac{N^2}{\hat{\omega}^3 m^3}\]</div>
<ul class="simple">
<li><p>Again using the relation between wave energy density and vertical velocity spectrum, this produces,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\left| \hat{w}_\text{sat} \right|^2 = 2.7 \times 10^{-2} \frac{1}{\hat{\omega} m^2 k_h^2}.\]</div>
</div></blockquote>
</li>
<li><p>Lastly, from the above definition for the vertical group velocity, <span class="math notranslate nohighlight">\(c_g\)</span>, it is possible to have altitudes for which <span class="math notranslate nohighlight">\(\hat{\omega} \rightarrow 0\)</span> and <span class="math notranslate nohighlight">\(c_g\)</span> similarly goes to zero.  In such a location the wave eenrgy density becomes infinite; however, the propagation time to such an altitude is infinite and it is therefore considered a “critical layer” because the ray path will never reach the layer.  In computing gravity wave spectra using the methods here, a propagation time of several hours is defined and used to prevent inclusion of the critical layer effects and also quantify the number of reflections for trapped components.</p></li>
</ul>
</div>
<div class="section" id="gravity-wave-implementation-in-stochprop">
<h2>Gravity Wave implementation in stochprop<a class="headerlink" href="#gravity-wave-implementation-in-stochprop" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>The implementation here…</p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="stochprop.html" class="btn btn-neutral float-right" title="API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="propagation.html" class="btn btn-neutral float-left" title="Propagation Statistics" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Philip Blom

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>